version: build-{branch}-#{build}

branches:
  only:
  # - master
  - develop

environment:
  matrix:
    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017
      CONFIG: Release

    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2019
      CONFIG: Release

build_script:
  - cmd: mkdir build
  - cmd: cd build
  - cmd: cmake .. -GNinja -DCML_BUILD_TESTING=ON
  - cmd: cmake --build . --config "%CONFIG%"

test_script:
  - cmd: ctest -V -C "%CONFIG%"

# init:
#   - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
 
# on_finish:
#   - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
